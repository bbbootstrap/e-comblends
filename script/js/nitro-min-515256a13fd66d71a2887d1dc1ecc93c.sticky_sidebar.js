(function(k){k.fn.theiaStickySidebar=function(i){var t={containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:true,minWidth:0,disableOnResponsiveLayouts:true,sidebarBehavior:"modern"};i=k.extend(t,i);i.additionalMarginTop=parseInt(i.additionalMarginTop)||0;i.additionalMarginBottom=parseInt(i.additionalMarginBottom)||0;e(i,this);function e(i,t){var e=a(i,t);if(!e){console.log("TST: Body width smaller than options.minWidth. Init is delayed.");k(document).scroll(function(e,o){return function(i){var t=a(e,o);if(t){k(this).unbind(i)}}}(i,t));k(window).resize(function(e,o){return function(i){var t=a(e,o);if(t){k(this).unbind(i)}}}(i,t))}}function a(i,t){if(i.initialized===true){return true}if(k("body").width()<i.minWidth){return false}o(i,t);return true}function o(y,i){y.initialized=true;k("head").append(k('<style>.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style>'));i.each(function(){var i={};i.sidebar=k(this);i.options=y||{};i.container=k(i.options.containerSelector);if(i.container.length==0){i.container=i.sidebar.parent()}i.sidebar.parents().css("-webkit-transform","none");i.sidebar.css({position:"relative",overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"});i.stickySidebar=i.sidebar.find(".theiaStickySidebar");if(i.stickySidebar.length==0){var e=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i;i.sidebar.find("script").filter(function(i,t){return t.type.length===0||t.type.match(e)}).remove();i.stickySidebar=k("<div>").addClass("theiaStickySidebar").append(i.sidebar.children());i.sidebar.append(i.stickySidebar)}i.marginTop=parseInt(i.sidebar.css("margin-top"));i.marginBottom=parseInt(i.sidebar.css("margin-bottom"));i.paddingTop=parseInt(i.sidebar.css("padding-top"));i.paddingBottom=parseInt(i.sidebar.css("padding-bottom"));var t=i.stickySidebar.offset().top;var o=i.stickySidebar.outerHeight();i.stickySidebar.css("padding-top",1);i.stickySidebar.css("padding-bottom",1);t-=i.stickySidebar.offset().top;o=i.stickySidebar.outerHeight()-o-t;if(t==0){i.stickySidebar.css("padding-top",0);i.stickySidebarPaddingTop=0}else{i.stickySidebarPaddingTop=1}if(o==0){i.stickySidebar.css("padding-bottom",0);i.stickySidebarPaddingBottom=0}else{i.stickySidebarPaddingBottom=1}i.previousScrollTop=null;i.fixedScrollTop=0;S();i.onScroll=function(i){if(!i.stickySidebar.is(":visible")){return}if(k("body").width()<i.options.minWidth){S();return}if(i.options.disableOnResponsiveLayouts){var t=i.sidebar.outerWidth(i.sidebar.css("float")=="none");if(t+50>i.container.width()){S();return}}var e=k(document).scrollTop();var o="static";if(e>=i.container.offset().top+(i.paddingTop+i.marginTop-i.options.additionalMarginTop)){var a=i.paddingTop+i.marginTop+y.additionalMarginTop;var r=i.paddingBottom+i.marginBottom+y.additionalMarginBottom;var n=i.container.offset().top;var d=i.container.offset().top+m(i.container);var s=0+y.additionalMarginTop;var c;var p=i.stickySidebar.outerHeight()+a+r<k(window).height();if(p){c=s+i.stickySidebar.outerHeight()}else{c=k(window).height()-i.marginBottom-i.paddingBottom-y.additionalMarginBottom}var b=n-e+i.paddingTop+i.marginTop;var f=d-e-i.paddingBottom-i.marginBottom;var l=i.stickySidebar.offset().top-e;var g=i.previousScrollTop-e;if(i.stickySidebar.css("position")=="fixed"){if(i.options.sidebarBehavior=="modern"){l+=g}}if(i.options.sidebarBehavior=="stick-to-top"){l=y.additionalMarginTop}if(i.options.sidebarBehavior=="stick-to-bottom"){l=c-i.stickySidebar.outerHeight()}if(g>0){l=Math.min(l,s)}else{l=Math.max(l,c-i.stickySidebar.outerHeight())}l=Math.max(l,b);l=Math.min(l,f-i.stickySidebar.outerHeight());var h=i.container.height()==i.stickySidebar.outerHeight();if(!h&&l==s){o="fixed"}else if(!h&&l==c-i.stickySidebar.outerHeight()){o="fixed"}else if(e+l-i.sidebar.offset().top-i.paddingTop<=y.additionalMarginTop){o="static"}else{o="absolute"}}if(o=="fixed"){i.stickySidebar.css({position:"fixed",width:i.sidebar.width(),top:l,left:i.sidebar.offset().left+parseInt(i.sidebar.css("padding-left"))})}else if(o=="absolute"){var u={};if(i.stickySidebar.css("position")!="absolute"){u.position="absolute";u.top=e+l-i.sidebar.offset().top-i.stickySidebarPaddingTop-i.stickySidebarPaddingBottom}u.width=i.sidebar.width();u.left="";i.stickySidebar.css(u)}else if(o=="static"){S()}if(o!="static"){if(i.options.updateSidebarHeight==true){i.sidebar.css({"min-height":i.stickySidebar.outerHeight()+i.stickySidebar.offset().top-i.sidebar.offset().top+i.paddingBottom})}}i.previousScrollTop=e};i.onScroll(i);k(document).scroll(function(i){return function(){i.onScroll(i)}}(i));k(window).resize(function(i){return function(){i.stickySidebar.css({position:"static"});i.onScroll(i)}}(i));function S(){i.fixedScrollTop=0;i.sidebar.css({"min-height":"1px"});i.stickySidebar.css({position:"static",width:""})}function m(i){var t=i.height();i.children().each(function(){t=Math.max(t,k(this).height())});return t}})}}})(jQuery);